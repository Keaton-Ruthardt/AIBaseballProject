<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Week 2: Vision Pipeline and Feature Engineering – AI Baseball Runner Advance Prediction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week3.html" rel="next">
<link href="./week1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-befe23ebd2f54d8af2c8a89d1a1611f1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e3272eb8ad839f511b46ec5b61bac709.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-9e815d78e4e602f0661e9792c40f22ad.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-e3272eb8ad839f511b46ec5b61bac709.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week2.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 2: Vision Pipeline and Feature Engineering</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">AI Baseball Runner Advance Prediction</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Keaton-Ruthardt/AIBaseballProject" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">AI Baseball Runner Advance Prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week 1: Project Foundation and Technical Setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 2: Vision Pipeline and Feature Engineering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 3: Data Collection and Pipeline Integration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week 4: Complete Pipeline and Performance Optimization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Week 5: Final Testing and Documentation</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">3.1</span> Overview</a></li>
  <li><a href="#team-contributions" id="toc-team-contributions" class="nav-link" data-scroll-target="#team-contributions"><span class="header-section-number">3.2</span> Team Contributions</a>
  <ul class="collapse">
  <li><a href="#diego-mendoza-documentation-feature-playbook" id="toc-diego-mendoza-documentation-feature-playbook" class="nav-link" data-scroll-target="#diego-mendoza-documentation-feature-playbook">Diego Mendoza: Documentation &amp; Feature Playbook</a></li>
  <li><a href="#joshua-cano-frame-extraction-pipeline" id="toc-joshua-cano-frame-extraction-pipeline" class="nav-link" data-scroll-target="#joshua-cano-frame-extraction-pipeline">Joshua Cano: Frame Extraction Pipeline</a></li>
  <li><a href="#keaton-ruthardt-player-tracking-system" id="toc-keaton-ruthardt-player-tracking-system" class="nav-link" data-scroll-target="#keaton-ruthardt-player-tracking-system">Keaton Ruthardt: Player Tracking System</a></li>
  <li><a href="#duoduo-cai-spatial-mapping-system" id="toc-duoduo-cai-spatial-mapping-system" class="nav-link" data-scroll-target="#duoduo-cai-spatial-mapping-system">Duoduo Cai: Spatial Mapping System</a></li>
  </ul></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">3.3</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#step-1-import-libraries-and-load-image" id="toc-step-1-import-libraries-and-load-image" class="nav-link" data-scroll-target="#step-1-import-libraries-and-load-image">Step 1: Import libraries and load image</a></li>
  <li><a href="#step-2-interactively-click-on-the-four-dots-and-print-the-result" id="toc-step-2-interactively-click-on-the-four-dots-and-print-the-result" class="nav-link" data-scroll-target="#step-2-interactively-click-on-the-four-dots-and-print-the-result">Step 2: Interactively click on the four dots and print the result</a></li>
  <li><a href="#step-3-auto-order-to-home-1b-2b-3b" id="toc-step-3-auto-order-to-home-1b-2b-3b" class="nav-link" data-scroll-target="#step-3-auto-order-to-home-1b-2b-3b">Step 3: Auto-order to [Home, 1B, 2B, 3B]</a></li>
  <li><a href="#step-4-homography-dlt-and-mapping-utils" id="toc-step-4-homography-dlt-and-mapping-utils" class="nav-link" data-scroll-target="#step-4-homography-dlt-and-mapping-utils">Step 4: Homography (DLT) and mapping utils</a></li>
  <li><a href="#step-5-sanity-check-homography-validation." id="toc-step-5-sanity-check-homography-validation." class="nav-link" data-scroll-target="#step-5-sanity-check-homography-validation.">Step 5: Sanity Check (Homography Validation).</a></li>
  <li><a href="#step-6-convert-any-pixel-click-one-or-fill-manually" id="toc-step-6-convert-any-pixel-click-one-or-fill-manually" class="nav-link" data-scroll-target="#step-6-convert-any-pixel-click-one-or-fill-manually">Step 6: Convert any pixel (click one or fill manually)</a></li>
  <li><a href="#step-7-overlay-labels-for-report" id="toc-step-7-overlay-labels-for-report" class="nav-link" data-scroll-target="#step-7-overlay-labels-for-report">Step 7: Overlay labels for report</a></li>
  <li><a href="#step-8-summary-of-conversion" id="toc-step-8-summary-of-conversion" class="nav-link" data-scroll-target="#step-8-summary-of-conversion">Step 8: Summary of Conversion</a></li>
  <li><a href="#step-9-measure-distance-between-two-outfielders" id="toc-step-9-measure-distance-between-two-outfielders" class="nav-link" data-scroll-target="#step-9-measure-distance-between-two-outfielders">Step 9: Measure distance between two outfielders</a></li>
  <li><a href="#ai-assistance-statement" id="toc-ai-assistance-statement" class="nav-link" data-scroll-target="#ai-assistance-statement">AI Assistance Statement</a></li>
  <li><a href="#samuel-bulnes-model-accuracy-testing" id="toc-samuel-bulnes-model-accuracy-testing" class="nav-link" data-scroll-target="#samuel-bulnes-model-accuracy-testing">Samuel Bulnes: Model Accuracy Testing</a></li>
  </ul></li>
  <li><a href="#technical-achievements" id="toc-technical-achievements" class="nav-link" data-scroll-target="#technical-achievements"><span class="header-section-number">3.4</span> Technical Achievements</a>
  <ul class="collapse">
  <li><a href="#computer-vision-pipeline" id="toc-computer-vision-pipeline" class="nav-link" data-scroll-target="#computer-vision-pipeline">1. Computer Vision Pipeline</a></li>
  <li><a href="#spatial-features" id="toc-spatial-features" class="nav-link" data-scroll-target="#spatial-features">2. Spatial Features</a></li>
  <li><a href="#model-optimization" id="toc-model-optimization" class="nav-link" data-scroll-target="#model-optimization">3. Model Optimization</a></li>
  </ul></li>
  <li><a href="#challenges-solutions" id="toc-challenges-solutions" class="nav-link" data-scroll-target="#challenges-solutions"><span class="header-section-number">3.5</span> Challenges &amp; Solutions</a>
  <ul class="collapse">
  <li><a href="#challenge-1-player-detection-in-crowds" id="toc-challenge-1-player-detection-in-crowds" class="nav-link" data-scroll-target="#challenge-1-player-detection-in-crowds">Challenge 1: Player Detection in Crowds</a></li>
  <li><a href="#challenge-2-camera-angle-variations" id="toc-challenge-2-camera-angle-variations" class="nav-link" data-scroll-target="#challenge-2-camera-angle-variations">Challenge 2: Camera Angle Variations</a></li>
  <li><a href="#challenge-3-model-complexity" id="toc-challenge-3-model-complexity" class="nav-link" data-scroll-target="#challenge-3-model-complexity">Challenge 3: Model Complexity</a></li>
  </ul></li>
  <li><a href="#key-metrics" id="toc-key-metrics" class="nav-link" data-scroll-target="#key-metrics"><span class="header-section-number">3.6</span> Key Metrics</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Keaton-Ruthardt/AIBaseballProject/edit/main/week2.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/Keaton-Ruthardt/AIBaseballProject/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 2: Vision Pipeline and Feature Engineering</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">3.1</span> Overview</h2>
<p>Week 2 marked a major technical milestone with the development of our core computer vision pipeline and the engineering of critical spatial features. The team successfully transformed raw video into structured, model-ready data.</p>
</section>
<section id="team-contributions" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="team-contributions"><span class="header-section-number">3.2</span> Team Contributions</h2>
<section id="diego-mendoza-documentation-feature-playbook" class="level3">
<h3 class="anchored" data-anchor-id="diego-mendoza-documentation-feature-playbook">Diego Mendoza: Documentation &amp; Feature Playbook</h3>
<p><strong>Objective</strong>: Document all features and establish data standards</p>
<p><strong>MLB-Provided Features</strong>:</p>
<ul>
<li><code>runner_base</code>: Base occupied at pitch (1B/2B/3B)</li>
<li><code>hit_distance</code>: Ball travel distance (feet)</li>
<li><code>bearing</code>: Horizontal angle from home to landing/catch (degrees)</li>
<li><code>launch_direction</code>: Pull/center/opposite field orientation</li>
<li><code>exit_speed</code> &amp; <code>exit_speed_squared</code>: Ball speed off bat (MPH and squared)</li>
<li><code>hangtime</code>: Flight duration (seconds)</li>
<li><code>launch_angle</code>: Vertical angle at contact (degrees)</li>
</ul>
<p><strong>Team-Computed Features</strong>:</p>
<ul>
<li><code>outfield_spread_event</code>: Spacing between LF/CF/RF</li>
<li><code>fielder_pos</code>: Which outfielder records the catch</li>
</ul>
</section>
<section id="joshua-cano-frame-extraction-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="joshua-cano-frame-extraction-pipeline">Joshua Cano: Frame Extraction Pipeline</h3>
<p><strong>Objective</strong>: Build reliable OpenCV pipeline for analysis-ready frames</p>
<p><strong>Technical Implementation</strong>:</p>
<p><img src="images/cv2.png" class="img-fluid"></p>
<p><strong>Performance Results</strong>:</p>
<ul>
<li>Test clip: 1280×720 @ 59.94 FPS, 1,400 frames</li>
<li>Extraction @ 30 FPS: 699 frames in 2.58s (~271 FPS processing)</li>
<li>Storage reduction: ~50% vs 60 FPS</li>
<li>Maintains motion detail for tracking</li>
</ul>
<p><strong>Impact</strong>:</p>
<ul>
<li>Faster training &amp; iteration</li>
<li>Lower storage footprint</li>
<li>Consistent timestamps for alignment</li>
<li>Foundation for all downstream tracking</li>
</ul>
</section>
<section id="keaton-ruthardt-player-tracking-system" class="level3">
<h3 class="anchored" data-anchor-id="keaton-ruthardt-player-tracking-system">Keaton Ruthardt: Player Tracking System</h3>
<p><strong>Objective</strong>: Detect and track outfielders using YOLOv8</p>
<p><strong>System Architecture</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SimpleOutfielderTracker:</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Simplified tracker that only detects real outfielders.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Stricter filtering to avoid false positives.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        model_size: <span class="bu">str</span> <span class="op">=</span> <span class="st">'n'</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        confidence_threshold: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        device: <span class="bu">str</span> <span class="op">=</span> <span class="st">'cpu'</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.confidence_threshold <span class="op">=</span> confidence_threshold</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.device <span class="op">=</span> device</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        model_name <span class="op">=</span> <span class="ss">f'yolov8</span><span class="sc">{</span>model_size<span class="sc">}</span><span class="ss">.pt'</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="ss">f"Loading </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> YOLO(model_name)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.tracker <span class="op">=</span> SimpleCentroidTracker(max_disappeared<span class="op">=</span><span class="dv">30</span>, max_distance<span class="op">=</span><span class="dv">150</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prev_frame <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_players(<span class="va">self</span>, frame: np.ndarray) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Detect all people in frame."""</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="va">self</span>.model.predict(</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            frame,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            conf<span class="op">=</span><span class="va">self</span>.confidence_threshold,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>            iou<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            classes<span class="op">=</span>[<span class="dv">0</span>],</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            device<span class="op">=</span><span class="va">self</span>.device,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            imgsz<span class="op">=</span><span class="dv">1280</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        detections <span class="op">=</span> []</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(results) <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> results[<span class="dv">0</span>].boxes <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            boxes <span class="op">=</span> results[<span class="dv">0</span>].boxes</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(boxes)):</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>                xyxy <span class="op">=</span> boxes.xyxy[i].cpu().numpy()</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                conf <span class="op">=</span> <span class="bu">float</span>(boxes.conf[i].cpu().numpy())</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                x1, y1, x2, y2 <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, xyxy)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>                cx <span class="op">=</span> <span class="bu">int</span>((x1 <span class="op">+</span> x2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>                cy <span class="op">=</span> <span class="bu">int</span>((y1 <span class="op">+</span> y2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>                area <span class="op">=</span> (x2 <span class="op">-</span> x1) <span class="op">*</span> (y2 <span class="op">-</span> y1)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                detections.append({</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'bbox'</span>: [x1, y1, x2, y2],</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'center'</span>: [cx, cy],</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'confidence'</span>: conf,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'area'</span>: area</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> detections</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> filter_to_real_outfielders(</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        detections: List[Dict],</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        frame_shape: <span class="bu">tuple</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co">        STRICT filtering to only get real outfielders in the field.</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co">        Rules:</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co">        - Must be in MIDDLE vertical region (not top where fans/scoreboards are)</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co">        - Must be reasonable size (not huge closeups, not tiny distant objects)</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co">        - Must be in field area (centered horizontally)</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        height, width <span class="op">=</span> frame_shape</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        outfielders <span class="op">=</span> []</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> det <span class="kw">in</span> detections:</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>            cx, cy <span class="op">=</span> det[<span class="st">'center'</span>]</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>            area <span class="op">=</span> det[<span class="st">'area'</span>]</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>            <span class="co"># STRICT RULES to avoid false positives:</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 1. Must be in MIDDLE of frame vertically (30% - 75%)</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>            <span class="co">#    This excludes fans/scoreboards at top (y &lt; 30%)</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> (height <span class="op">*</span> <span class="fl">0.30</span> <span class="op">&lt;</span> cy <span class="op">&lt;</span> height <span class="op">*</span> <span class="fl">0.75</span>):</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2. Size constraints</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> area <span class="op">&lt;</span> <span class="dv">3000</span> <span class="kw">or</span> area <span class="op">&gt;</span> <span class="dv">35000</span>:</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 3. Must be reasonably centered horizontally (10% - 90%)</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> (width <span class="op">*</span> <span class="fl">0.10</span> <span class="op">&lt;</span> cx <span class="op">&lt;</span> width <span class="op">*</span> <span class="fl">0.90</span>):</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>            outfielders.append(det)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> outfielders</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_ball(<span class="va">self</span>, frame: np.ndarray) <span class="op">-&gt;</span> Optional[List[<span class="bu">int</span>]]:</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Detect ball position."""</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="va">self</span>.model.predict(</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>            frame,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>            conf<span class="op">=</span><span class="fl">0.15</span>,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>            iou<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>            classes<span class="op">=</span>[<span class="dv">32</span>],  <span class="co"># Sports ball</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>            verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>            device<span class="op">=</span><span class="va">self</span>.device,</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>            imgsz<span class="op">=</span><span class="dv">1280</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Key Features</strong>:</p>
<ul>
<li><strong>Adaptive Sizing</strong>:
<ul>
<li>Dynamic min-area based on candidate count</li>
<li>7,200 px² when &gt;6 candidates (filter fans)</li>
<li>2,500 px² in sparse frames (capture distant players)</li>
</ul></li>
<li><strong>Outfielder Focus</strong>: Vertical band filter (Y ≈ 0.10–0.75)</li>
<li><strong>Position Assignment</strong>: Sort by x-coordinate → LF (left), CF (center), RF (right)</li>
<li><strong>Windowing</strong>: Process only play frames (150–240) to save compute</li>
</ul>
<p><strong>Outputs</strong>:</p>
<ul>
<li>Annotated MP4 with LF/CF/RF labels and spacing lines</li>
<li>CSV per frame with player positions and distances</li>
<li>Ball and catch detection flags</li>
</ul>
<p><strong>Results</strong>:</p>
<ul>
<li>Visibility rate: 10.8% of frames had classifiable outfielders</li>
<li>Catch identification: 2 catches detected (frames 205 &amp; 216)</li>
<li>Spacing metrics: LF-CF, CF-RF, LF-RF Euclidean distances</li>
</ul>
</section>
<section id="duoduo-cai-spatial-mapping-system" class="level3">
<h3 class="anchored" data-anchor-id="duoduo-cai-spatial-mapping-system">Duoduo Cai: Spatial Mapping System</h3>
<p><strong>Objective</strong>: Convert 2D pixels to real-world field positions</p>
</section>
</section>
<section id="introduction" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="introduction"><span class="header-section-number">3.3</span> Introduction</h2>
<p>This prototype demonstrates converting <strong>2D pixel coordinates</strong> from a baseball video frame<br>
into <strong>real-world field positions (feet)</strong> using homography transformation.</p>
<section id="step-1-import-libraries-and-load-image" class="level3">
<h3 class="anchored" data-anchor-id="step-1-import-libraries-and-load-image">Step 1: Import libraries and load image</h3>
<p>The baseball field picture (field_frame.png) has been loaded and displayed. Users are instructed to click four critical spots on the field—Home, 1B, 2B, and 3B—to specify the homography transition.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>matplotlib.use(<span class="st">'TkAgg'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">"field_frame.png"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Click four points: Home → 1B → 2B → 3B"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-2-interactively-click-on-the-four-dots-and-print-the-result" class="level3">
<h3 class="anchored" data-anchor-id="step-2-interactively-click-on-the-four-dots-and-print-the-result">Step 2: Interactively click on the four dots and print the result</h3>
<p>After clicking on the four bases, the pixel coordinates are printed. For example: [(1021.12, 1131.32), (2037.17, 753.56), (1062.81, 141.33), (7.69, 745.74)]. These are the positions of the bases in the image (pixels).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> plt.ginput(<span class="dv">4</span>, timeout <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Clicked pixel coordinates:"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(points)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-3-auto-order-to-home-1b-2b-3b" class="level3">
<h3 class="anchored" data-anchor-id="step-3-auto-order-to-home-1b-2b-3b">Step 3: Auto-order to [Home, 1B, 2B, 3B]</h3>
<p>The clicked points are automatically ordered as Home → 1B → 2B → 3B. This ensures consistency when computing the transformation matrix.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>points_raw <span class="op">=</span> np.array(points, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> points_raw[:,<span class="dv">1</span>]<span class="op">;</span> xs <span class="op">=</span> points_raw[:,<span class="dv">0</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>home_idx   <span class="op">=</span> np.argmax(ys)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>second_idx <span class="op">=</span> np.argmin(ys)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>remain     <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>) <span class="cf">if</span> i <span class="kw">not</span> <span class="kw">in</span> (home_idx, second_idx)]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>first_idx  <span class="op">=</span> remain[np.argmax(xs[remain])]   <span class="co"># right-bottom</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>third_idx  <span class="op">=</span> remain[np.argmin(xs[remain])]   <span class="co"># left-bottom</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>src_pts <span class="op">=</span> np.array([</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    points_raw[home_idx],   <span class="co"># Home</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    points_raw[first_idx],  <span class="co"># 1B</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    points_raw[second_idx], <span class="co"># 2B</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    points_raw[third_idx],  <span class="co"># 3B</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ordered src_pts:</span><span class="ch">\n</span><span class="st">"</span>, src_pts)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-4-homography-dlt-and-mapping-utils" class="level3">
<h3 class="anchored" data-anchor-id="step-4-homography-dlt-and-mapping-utils">Step 4: Homography (DLT) and mapping utils</h3>
<p>The Direct Linear Transform (DLT) algorithm generates the homography matrix (H), which maps picture pixels to real field coordinates (feet).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dst_pts <span class="op">=</span> np.array([[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">90</span>,<span class="dv">0</span>],[<span class="dv">90</span>,<span class="dv">90</span>],[<span class="dv">0</span>,<span class="dv">90</span>]], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_homography(src, dst):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    A<span class="op">=</span>[]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (x,y),(X,Y) <span class="kw">in</span> <span class="bu">zip</span>(src,dst):</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        A <span class="op">+=</span> [[<span class="op">-</span>x,<span class="op">-</span>y,<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, x<span class="op">*</span>X, y<span class="op">*</span>X, X],</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>              [ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,<span class="op">-</span>x,<span class="op">-</span>y,<span class="op">-</span><span class="dv">1</span>, x<span class="op">*</span>Y, y<span class="op">*</span>Y, Y]]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    U,S,Vt <span class="op">=</span> np.linalg.svd(np.asarray(A))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> Vt[<span class="op">-</span><span class="dv">1</span>] <span class="op">/</span> Vt[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> h.reshape(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> apply_homography(H, pts):</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    pts <span class="op">=</span> np.asarray(pts, <span class="bu">float</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    hom <span class="op">=</span> np.hstack([pts, np.ones((pts.shape[<span class="dv">0</span>],<span class="dv">1</span>))])</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    trans <span class="op">=</span> (H <span class="op">@</span> hom.T).T</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    trans[:,:<span class="dv">2</span>] <span class="op">/=</span> trans[:,[<span class="dv">2</span>]]</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> trans[:,:<span class="dv">2</span>]</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> compute_homography(src_pts, dst_pts)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"H:</span><span class="ch">\n</span><span class="st">"</span>, H)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the H calculated last week to the desktop deliverable3 project</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np, os</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>BASE <span class="op">=</span> os.path.expanduser(<span class="st">"~/Desktop/deliverable3_feature_extraction"</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>out_path <span class="op">=</span> os.path.join(BASE, <span class="st">"data"</span>, <span class="st">"homography"</span>, <span class="st">"H.npy"</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>os.makedirs(os.path.dirname(out_path), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>np.save(out_path, H.astype(np.float32))</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>H_check <span class="op">=</span> np.load(out_path)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Saved to:"</span>, out_path, <span class="st">"shape:"</span>, H_check.shape, <span class="st">"dtype:"</span>, H_check.dtype)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-5-sanity-check-homography-validation." class="level3">
<h3 class="anchored" data-anchor-id="step-5-sanity-check-homography-validation.">Step 5: Sanity Check (Homography Validation).</h3>
<p>To evaluate the correctness of the homography transformation, we reprojected four manually chosen base points (Home, 1B, 2B, and 3B) into real-world field coordinates.<br>
The coordinates found were about Home (0.0, 0.0), 1B (90.0, 0.0), 2B (90.0, 90.0), and 3B (0.0, 90.0), completely matching the normal baseball infield dimensions of 90 × 90 ft. This indicates that the transformation matrix accurately preserves spatial geometry, making the pixel-to-field mapping reliable for player position estimation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>check_ft <span class="op">=</span> apply_homography(H, src_pts)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"mapped 4 corners (feet):</span><span class="ch">\n</span><span class="st">"</span>, check_ft)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-6-convert-any-pixel-click-one-or-fill-manually" class="level3">
<h3 class="anchored" data-anchor-id="step-6-convert-any-pixel-click-one-or-fill-manually">Step 6: Convert any pixel (click one or fill manually)</h3>
<p>A new pixel point (such as the runner’s foot) is picked. It is translated from pixel coordinates (842.32, 395.44) to field coordinates (65.93 ft, 81.76 ft), demonstrating successful 2D-to-real-world mapping.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">110</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)<span class="op">;</span> plt.title(<span class="st">"Click runner foot (1 point)"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>runner_click <span class="op">=</span> plt.ginput(<span class="dv">1</span>, timeout<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>runner_px <span class="op">=</span> np.array(runner_click, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># runner_px = np.array([[1200, 900]], dtype=float)  # Manual values can be used as substitutes</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>runner_ft <span class="op">=</span> apply_homography(H, runner_px)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"runner pixel -&gt; feet:"</span>, runner_px, <span class="st">"=&gt;"</span>, runner_ft)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-7-overlay-labels-for-report" class="level3">
<h3 class="anchored" data-anchor-id="step-7-overlay-labels-for-report">Step 7: Overlay labels for report</h3>
<p>The selected base points (Home, 1B, 2B, and 3B) are superimposed on the image with yellow labels to ensure that all points were accurately registered throughout the transformation process.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">"Home"</span>,<span class="st">"1B"</span>,<span class="st">"2B"</span>,<span class="st">"3B"</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x,y),lab <span class="kw">in</span> <span class="bu">zip</span>(src_pts, labels):</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    plt.scatter([x],[y], s<span class="op">=</span><span class="dv">110</span>, facecolors<span class="op">=</span><span class="st">'none'</span>, edgecolors<span class="op">=</span><span class="st">'yellow'</span>, linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    plt.text(x<span class="op">+</span><span class="dv">8</span>, y<span class="op">-</span><span class="dv">8</span>, lab, color<span class="op">=</span><span class="st">'yellow'</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>             bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.55</span>, pad<span class="op">=</span><span class="dv">2</span>), fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Selected points (Home → 1B → 2B → 3B)"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig("selected_points_overlay.png", dpi=160, bbox_inches='tight')</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-8-summary-of-conversion" class="level3">
<h3 class="anchored" data-anchor-id="step-8-summary-of-conversion">Step 8: Summary of Conversion</h3>
<p>The validated homography matrix was used to map the selected player’s foot to real-world coordinates of about (X = 65.93 ft, Y = 81.76 ft). This point is fairly close to the pitcher’s mound (approximately 60.5 feet from home plate), demonstrating the geometric correctness and reliability of our coordinate translation. The results show that our homography-based method can successfully transform 2D pixel positions from a video frame to genuine on-field locations with realistic precision.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(check_ft)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>pt <span class="op">=</span> np.<span class="bu">round</span>(runner_ft, <span class="dv">2</span>) </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Runner (feet) ≈ X=</span><span class="sc">{</span>pt[<span class="dv">0</span>,<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> ft, Y=</span><span class="sc">{</span>pt[<span class="dv">0</span>,<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> ft"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-9-measure-distance-between-two-outfielders" class="level3">
<h3 class="anchored" data-anchor-id="step-9-measure-distance-between-two-outfielders">Step 9: Measure distance between two outfielders</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.1 Load the same broadcast frame and ask the user to click two outfielders</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">"outfield_frame.png"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Click two outfielders (left → right)"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect two pixel coordinates (click left OF first, then right OF)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>of_px <span class="op">=</span> plt.ginput(<span class="dv">2</span>, timeout<span class="op">=</span><span class="dv">0</span>)     <span class="co"># returns [(x1,y1), (x2,y2)]</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Clicked pixel coords (outfielders):"</span>, of_px)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.2 Convert pixel coordinates to field coordinates (feet) via homography</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>of_ft <span class="op">=</span> apply_homography(H, np.array(of_px, dtype<span class="op">=</span><span class="bu">float</span>))</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Outfielders in field coordinates (feet):</span><span class="ch">\n</span><span class="st">"</span>, np.<span class="bu">round</span>(of_ft, <span class="dv">2</span>))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.3 Compute Euclidean distance between the two outfielders in feet</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>dist_ft <span class="op">=</span> <span class="bu">float</span>(np.linalg.norm(of_ft[<span class="dv">0</span>] <span class="op">-</span> of_ft[<span class="dv">1</span>]))</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Distance between outfielders ≈ </span><span class="sc">{</span>dist_ft<span class="sc">:.2f}</span><span class="ss"> ft"</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.4 (Optional) Visual overlay for the report</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">140</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Outfielders distance ≈ </span><span class="sc">{</span>dist_ft<span class="sc">:.1f}</span><span class="ss"> ft"</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x, y), label <span class="kw">in</span> <span class="bu">zip</span>(of_px, [<span class="st">"OF-1"</span>, <span class="st">"OF-2"</span>]):</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    plt.scatter([x], [y], s<span class="op">=</span><span class="dv">120</span>, c<span class="op">=</span><span class="st">'cyan'</span>, marker<span class="op">=</span><span class="st">'x'</span>, linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    plt.text(x<span class="op">+</span><span class="dv">10</span>, y<span class="op">-</span><span class="dv">10</span>, label, color<span class="op">=</span><span class="st">'cyan'</span>,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>             bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.55</span>, pad<span class="op">=</span><span class="dv">2</span>), fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig("outfielders_distance_overlay.png", dpi=160, bbox_inches='tight')</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The results demonstrate that two outfielders were manually selected from the video frame, with pixel coordinates (367.85, 1108.08) and (1863.53, 1174.72). These pixel positions were then converted into real-world field coordinates using the previously computed homography matrix, yielding approximations of (-31.39, 38.27) ft and (41.13, -54.64) ft.</p>
<p>The software calculated the Euclidean distance between these two positions and decided that the outfielders are separated by around 117.9 feet on the field. This figure is appropriate for a Major League Baseball outfield arrangement in which players normally maintain a spacing of 110-130 feet, depending on stadium geometry and defensive placement.</p>
<p>The visualization additionally marks the two selected positions as “OF-1” and “OF-2” on the image, indicating that the transformation correctly transfers on-screen player placements to their real-world distances.</p>
</section>
<section id="ai-assistance-statement" class="level3">
<h3 class="anchored" data-anchor-id="ai-assistance-statement">AI Assistance Statement</h3>
<p>AI assistance: ChatGPT was used extensively in this deliverable. It helps me understand better what I should do for this week’s deliverable, and it guides me step by step with my prompt. The majority of the code structure, Python functions, and written explanations were initially generated with AI assistance. I used ChatGPT to help me draft prototype code for homography computation, coordinate transformation, visualization, and distance calculation. I then executed all code myself, debugged errors, verified the homography outputs, selected the calibration points, confirmed the pixel-to-field mapping, and interpreted every result.<br>
This document reflects my understanding of the method, while the AI tool assisted me in writing and structuring the initial code and explanations.</p>
<p>Homography transformation to map pixel coordinates to field coordinates:</p>
<p><img src="images/duo.png" class="img-fluid"></p>
<p><strong>Quality Checks</strong>:</p>
<ul>
<li>Base square ≈ 90 ft sides (±2 ft)</li>
<li>Foul lines approximately orthogonal</li>
<li>Residual reprojection error ≤ 2 px</li>
<li>Reject if fewer than 4 reliable points</li>
</ul>
<p><strong>Impact</strong>:</p>
<ul>
<li>Converts video into model-ready geometry (feet)</li>
<li>Makes features comparable across games/stadiums/cameras</li>
<li>Enables true distance calculations for <code>outfield_spread_ft</code></li>
</ul>
</section>
<section id="samuel-bulnes-model-accuracy-testing" class="level3">
<h3 class="anchored" data-anchor-id="samuel-bulnes-model-accuracy-testing">Samuel Bulnes: Model Accuracy Testing</h3>
<p><strong>Objective</strong>: Optimize feature set while maintaining performance</p>
<p><strong>Feature Reduction Analysis</strong>:</p>
<p>Original model: 45 features → Optimized: 10 features (-78% complexity)</p>
<p><strong>Top 10 Features by Importance</strong>:</p>
<ol type="1">
<li><code>runner_base</code> (28.6%)</li>
<li><code>hit_distance</code> (27.9%)</li>
<li><code>bearing</code> (10.5%)</li>
<li><code>launch_angle</code> (7.5%)</li>
<li><code>launch_direction</code> (6.9%)</li>
<li><code>exit_speed</code> (4.8%)</li>
<li><code>hangtime</code> (4.5%)</li>
<li><code>exit_speed_squared</code> (4.4%)</li>
<li><code>fielder_pos</code> (2.5%)</li>
<li><code>outfield_spread_event</code> (2.5%)</li>
</ol>
<p><strong>Performance Validation</strong>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th>45 Features</th>
<th>10 Features</th>
<th>Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Random Forest</td>
<td>0.3951</td>
<td>0.3795</td>
<td>+3.9%</td>
</tr>
<tr class="even">
<td>Gradient Boosting</td>
<td>0.3647</td>
<td>0.3890</td>
<td>-6.7%</td>
</tr>
<tr class="odd">
<td>Logistic Regression</td>
<td>0.4200</td>
<td>0.4416</td>
<td>-5.1%</td>
</tr>
</tbody>
</table>
<p><strong>Best Model</strong>: Random Forest with 10 features (Log Loss = 0.3795)</p>
<p><strong>Impact</strong>:</p>
<ul>
<li>70%+ reduction in data prep and training time</li>
<li>Maintains core predictive signal</li>
<li>Faster retraining and lighter deployment</li>
<li>Ready for production scaling</li>
</ul>
</section>
</section>
<section id="technical-achievements" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="technical-achievements"><span class="header-section-number">3.4</span> Technical Achievements</h2>
<section id="computer-vision-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="computer-vision-pipeline">1. Computer Vision Pipeline</h3>
<ul>
<li><p><strong>YOLOv8 Integration</strong>: Real-time player detection</p></li>
<li><p><strong>Position Classification</strong>: Automatic LF/CF/RF assignment</p></li>
<li><p><strong>Catch Detection</strong>: Ball-to-player distance calculation</p></li>
<li><p><strong>ID Persistence</strong>: Track players across frames</p></li>
</ul>
</section>
<section id="spatial-features" class="level3">
<h3 class="anchored" data-anchor-id="spatial-features">2. Spatial Features</h3>
<ul>
<li><p><strong>Outfield Spread</strong>: Quantitative field coverage metric</p></li>
<li><p><strong>Fielder Position</strong>: Categorical catch assignment</p></li>
<li><p><strong>Pixel-to-Feet Conversion</strong>: Real-world distance calculations</p></li>
<li><p><strong>Multi-Camera Support</strong>: Homography-based calibration</p></li>
</ul>
</section>
<section id="model-optimization" class="level3">
<h3 class="anchored" data-anchor-id="model-optimization">3. Model Optimization</h3>
<ul>
<li><p><strong>Feature Selection</strong>: 45 → 10 features with minimal loss</p></li>
<li><p><strong>Performance Validation</strong>: Cross-validation across models</p></li>
<li><p><strong>Importance Analysis</strong>: Identify key predictive features</p></li>
</ul>
</section>
</section>
<section id="challenges-solutions" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="challenges-solutions"><span class="header-section-number">3.5</span> Challenges &amp; Solutions</h2>
<section id="challenge-1-player-detection-in-crowds" class="level3">
<h3 class="anchored" data-anchor-id="challenge-1-player-detection-in-crowds">Challenge 1: Player Detection in Crowds</h3>
<p><strong>Problem</strong>: YOLO detects fans and non-players</p>
<p><strong>Solution</strong>: Adaptive area thresholds + vertical band filtering</p>
</section>
<section id="challenge-2-camera-angle-variations" class="level3">
<h3 class="anchored" data-anchor-id="challenge-2-camera-angle-variations">Challenge 2: Camera Angle Variations</h3>
<p><strong>Problem</strong>: Different stadiums/broadcasts have different perspectives</p>
<p><strong>Solution</strong>: Homography calibration per video with quality checks</p>
</section>
<section id="challenge-3-model-complexity" class="level3">
<h3 class="anchored" data-anchor-id="challenge-3-model-complexity">Challenge 3: Model Complexity</h3>
<p><strong>Problem</strong>: 45 features slow down training and deployment</p>
<p><strong>Solution</strong>: Feature importance analysis → keep top 10 features</p>
</section>
</section>
<section id="key-metrics" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="key-metrics"><span class="header-section-number">3.6</span> Key Metrics</h2>
<ul>
<li><strong>Frame Processing</strong>: 271 FPS extraction speed</li>
<li><strong>Player Detection</strong>: 10.8% frame visibility rate</li>
<li><strong>Model Performance</strong>: Log Loss 0.3795 (10 features)</li>
<li><strong>Complexity Reduction</strong>: 78% fewer features</li>
<li><strong>Storage Savings</strong>: 50% reduction with 30 FPS</li>
</ul>
<hr>
<p><em>Week 2 transformed raw video into structured, model-ready data through advanced computer vision and feature engineering.</em></p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week1.html" class="pagination-link" aria-label="Week 1: Project Foundation and Technical Setup">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week 1: Project Foundation and Technical Setup</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week3.html" class="pagination-link" aria-label="Week 3: Data Collection and Pipeline Integration">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 3: Data Collection and Pipeline Integration</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Week 2: Vision Pipeline and Feature Engineering</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Week 2 marked a major technical milestone with the development of our core computer vision pipeline and the engineering of critical spatial features. The team successfully transformed raw video into structured, model-ready data.</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Team Contributions</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">### Diego Mendoza: Documentation &amp; Feature Playbook</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>**Objective**: Document all features and establish data standards</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>**MLB-Provided Features**:</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`runner_base`</span>: Base occupied at pitch (1B/2B/3B)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`hit_distance`</span>: Ball travel distance (feet)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`bearing`</span>: Horizontal angle from home to landing/catch (degrees)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`launch_direction`</span>: Pull/center/opposite field orientation</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`exit_speed`</span> &amp; <span class="in">`exit_speed_squared`</span>: Ball speed off bat (MPH and squared)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`hangtime`</span>: Flight duration (seconds)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`launch_angle`</span>: Vertical angle at contact (degrees)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>**Team-Computed Features**:</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`outfield_spread_event`</span>: Spacing between LF/CF/RF</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`fielder_pos`</span>: Which outfielder records the catch</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="fu">### Joshua Cano: Frame Extraction Pipeline</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>**Objective**: Build reliable OpenCV pipeline for analysis-ready frames</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>**Technical Implementation**:</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/cv2.png)</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>**Performance Results**:</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Test clip: 1280×720 @ 59.94 FPS, 1,400 frames</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Extraction @ 30 FPS: 699 frames in 2.58s (~271 FPS processing)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Storage reduction: ~50% vs 60 FPS</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Maintains motion detail for tracking</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>**Impact**:</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Faster training &amp; iteration</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Lower storage footprint</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consistent timestamps for alignment</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Foundation for all downstream tracking</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a><span class="fu">### Keaton Ruthardt: Player Tracking System</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>**Objective**: Detect and track outfielders using YOLOv8</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>**System Architecture**:</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SimpleOutfielderTracker:</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="co">    Simplified tracker that only detects real outfielders.</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a><span class="co">    Stricter filtering to avoid false positives.</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>        model_size: <span class="bu">str</span> <span class="op">=</span> <span class="st">'n'</span>,</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>        confidence_threshold: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>        device: <span class="bu">str</span> <span class="op">=</span> <span class="st">'cpu'</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.confidence_threshold <span class="op">=</span> confidence_threshold</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.device <span class="op">=</span> device</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>        model_name <span class="op">=</span> <span class="ss">f'yolov8</span><span class="sc">{</span>model_size<span class="sc">}</span><span class="ss">.pt'</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="ss">f"Loading </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> YOLO(model_name)</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.tracker <span class="op">=</span> SimpleCentroidTracker(max_disappeared<span class="op">=</span><span class="dv">30</span>, max_distance<span class="op">=</span><span class="dv">150</span>)</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prev_frame <span class="op">=</span> <span class="va">None</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_players(<span class="va">self</span>, frame: np.ndarray) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Detect all people in frame."""</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="va">self</span>.model.predict(</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>            frame,</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>            conf<span class="op">=</span><span class="va">self</span>.confidence_threshold,</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>            iou<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>            classes<span class="op">=</span>[<span class="dv">0</span>],</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>            verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>            device<span class="op">=</span><span class="va">self</span>.device,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>            imgsz<span class="op">=</span><span class="dv">1280</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>        detections <span class="op">=</span> []</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(results) <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> results[<span class="dv">0</span>].boxes <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>            boxes <span class="op">=</span> results[<span class="dv">0</span>].boxes</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(boxes)):</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>                xyxy <span class="op">=</span> boxes.xyxy[i].cpu().numpy()</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>                conf <span class="op">=</span> <span class="bu">float</span>(boxes.conf[i].cpu().numpy())</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>                x1, y1, x2, y2 <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, xyxy)</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>                cx <span class="op">=</span> <span class="bu">int</span>((x1 <span class="op">+</span> x2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>                cy <span class="op">=</span> <span class="bu">int</span>((y1 <span class="op">+</span> y2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>                area <span class="op">=</span> (x2 <span class="op">-</span> x1) <span class="op">*</span> (y2 <span class="op">-</span> y1)</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>                detections.append({</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'bbox'</span>: [x1, y1, x2, y2],</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'center'</span>: [cx, cy],</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'confidence'</span>: conf,</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'area'</span>: area</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> detections</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> filter_to_real_outfielders(</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>,</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>        detections: List[Dict],</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>        frame_shape: <span class="bu">tuple</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a><span class="co">        STRICT filtering to only get real outfielders in the field.</span></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a><span class="co">        Rules:</span></span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a><span class="co">        - Must be in MIDDLE vertical region (not top where fans/scoreboards are)</span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a><span class="co">        - Must be reasonable size (not huge closeups, not tiny distant objects)</span></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a><span class="co">        - Must be in field area (centered horizontally)</span></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>        height, width <span class="op">=</span> frame_shape</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>        outfielders <span class="op">=</span> []</span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> det <span class="kw">in</span> detections:</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>            cx, cy <span class="op">=</span> det[<span class="st">'center'</span>]</span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>            area <span class="op">=</span> det[<span class="st">'area'</span>]</span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>            <span class="co"># STRICT RULES to avoid false positives:</span></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 1. Must be in MIDDLE of frame vertically (30% - 75%)</span></span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>            <span class="co">#    This excludes fans/scoreboards at top (y &lt; 30%)</span></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> (height <span class="op">*</span> <span class="fl">0.30</span> <span class="op">&lt;</span> cy <span class="op">&lt;</span> height <span class="op">*</span> <span class="fl">0.75</span>):</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2. Size constraints</span></span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> area <span class="op">&lt;</span> <span class="dv">3000</span> <span class="kw">or</span> area <span class="op">&gt;</span> <span class="dv">35000</span>:</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 3. Must be reasonably centered horizontally (10% - 90%)</span></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> (width <span class="op">*</span> <span class="fl">0.10</span> <span class="op">&lt;</span> cx <span class="op">&lt;</span> width <span class="op">*</span> <span class="fl">0.90</span>):</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>            outfielders.append(det)</span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> outfielders</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> detect_ball(<span class="va">self</span>, frame: np.ndarray) <span class="op">-&gt;</span> Optional[List[<span class="bu">int</span>]]:</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Detect ball position."""</span></span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="va">self</span>.model.predict(</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>            frame,</span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>            conf<span class="op">=</span><span class="fl">0.15</span>,</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>            iou<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>            classes<span class="op">=</span>[<span class="dv">32</span>],  <span class="co"># Sports ball</span></span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>            verbose<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>            device<span class="op">=</span><span class="va">self</span>.device,</span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>            imgsz<span class="op">=</span><span class="dv">1280</span></span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>**Key Features**:</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Adaptive Sizing**:</span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a><span class="ss">  -  </span>Dynamic min-area based on candidate count</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>7,200 px² when &gt;6 candidates (filter fans)</span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>2,500 px² in sparse frames (capture distant players)</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Outfielder Focus**: Vertical band filter (Y ≈ 0.10–0.75)</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Position Assignment**: Sort by x-coordinate → LF (left), CF (center), RF (right)</span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Windowing**: Process only play frames (150–240) to save compute</span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>**Outputs**:</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Annotated MP4 with LF/CF/RF labels and spacing lines</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CSV per frame with player positions and distances</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ball and catch detection flags</span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>**Results**:</span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Visibility rate: 10.8% of frames had classifiable outfielders</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Catch identification: 2 catches detected (frames 205 &amp; 216)</span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Spacing metrics: LF-CF, CF-RF, LF-RF Euclidean distances</span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a><span class="fu">### Duoduo Cai: Spatial Mapping System</span></span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>**Objective**: Convert 2D pixels to real-world field positions</span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>This prototype demonstrates converting **2D pixel coordinates** from a baseball video frame  </span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>into **real-world field positions (feet)** using homography transformation.</span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Import libraries and load image</span></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>The baseball field picture (field_frame.png) has been loaded and displayed.</span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a> Users are instructed to click four critical spots on the field—Home, 1B, 2B, and 3B—to specify the homography transition.</span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>matplotlib.use(<span class="st">'TkAgg'</span>)</span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">"field_frame.png"</span>)</span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Click four points: Home → 1B → 2B → 3B"</span>)</span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Interactively click on the four dots and print the result</span></span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a>After clicking on the four bases, the pixel coordinates are printed.</span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a> For example: <span class="co">[</span><span class="ot">(1021.12, 1131.32), (2037.17, 753.56), (1062.81, 141.33), (7.69, 745.74)</span><span class="co">]</span>.</span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a> These are the positions of the bases in the image (pixels).</span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> plt.ginput(<span class="dv">4</span>, timeout <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Clicked pixel coordinates:"</span>)</span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(points)</span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Auto-order to [Home, 1B, 2B, 3B]</span></span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a>The clicked points are automatically ordered as Home → 1B → 2B → 3B.</span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a>This ensures consistency when computing the transformation matrix.</span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a>points_raw <span class="op">=</span> np.array(points, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> points_raw[:,<span class="dv">1</span>]<span class="op">;</span> xs <span class="op">=</span> points_raw[:,<span class="dv">0</span>]</span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a>home_idx   <span class="op">=</span> np.argmax(ys)</span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a>second_idx <span class="op">=</span> np.argmin(ys)</span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a>remain     <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>) <span class="cf">if</span> i <span class="kw">not</span> <span class="kw">in</span> (home_idx, second_idx)]</span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>first_idx  <span class="op">=</span> remain[np.argmax(xs[remain])]   <span class="co"># right-bottom</span></span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a>third_idx  <span class="op">=</span> remain[np.argmin(xs[remain])]   <span class="co"># left-bottom</span></span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a>src_pts <span class="op">=</span> np.array([</span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a>    points_raw[home_idx],   <span class="co"># Home</span></span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a>    points_raw[first_idx],  <span class="co"># 1B</span></span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a>    points_raw[second_idx], <span class="co"># 2B</span></span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a>    points_raw[third_idx],  <span class="co"># 3B</span></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a>], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ordered src_pts:</span><span class="ch">\n</span><span class="st">"</span>, src_pts)</span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-248"><a href="#cb11-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-249"><a href="#cb11-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Homography (DLT) and mapping utils</span></span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a>The Direct Linear Transform (DLT) algorithm generates the homography matrix (H), which maps picture pixels to real field coordinates (feet).</span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a>dst_pts <span class="op">=</span> np.array([[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">90</span>,<span class="dv">0</span>],[<span class="dv">90</span>,<span class="dv">90</span>],[<span class="dv">0</span>,<span class="dv">90</span>]], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_homography(src, dst):</span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a>    A<span class="op">=</span>[]</span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (x,y),(X,Y) <span class="kw">in</span> <span class="bu">zip</span>(src,dst):</span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a>        A <span class="op">+=</span> [[<span class="op">-</span>x,<span class="op">-</span>y,<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, x<span class="op">*</span>X, y<span class="op">*</span>X, X],</span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a>              [ <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,<span class="op">-</span>x,<span class="op">-</span>y,<span class="op">-</span><span class="dv">1</span>, x<span class="op">*</span>Y, y<span class="op">*</span>Y, Y]]</span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a>    U,S,Vt <span class="op">=</span> np.linalg.svd(np.asarray(A))</span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> Vt[<span class="op">-</span><span class="dv">1</span>] <span class="op">/</span> Vt[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> h.reshape(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> apply_homography(H, pts):</span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a>    pts <span class="op">=</span> np.asarray(pts, <span class="bu">float</span>)</span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a>    hom <span class="op">=</span> np.hstack([pts, np.ones((pts.shape[<span class="dv">0</span>],<span class="dv">1</span>))])</span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a>    trans <span class="op">=</span> (H <span class="op">@</span> hom.T).T</span>
<span id="cb11-269"><a href="#cb11-269" aria-hidden="true" tabindex="-1"></a>    trans[:,:<span class="dv">2</span>] <span class="op">/=</span> trans[:,[<span class="dv">2</span>]]</span>
<span id="cb11-270"><a href="#cb11-270" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> trans[:,:<span class="dv">2</span>]</span>
<span id="cb11-271"><a href="#cb11-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-272"><a href="#cb11-272" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> compute_homography(src_pts, dst_pts)</span>
<span id="cb11-273"><a href="#cb11-273" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"H:</span><span class="ch">\n</span><span class="st">"</span>, H)</span>
<span id="cb11-274"><a href="#cb11-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-275"><a href="#cb11-275" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the H calculated last week to the desktop deliverable3 project</span></span>
<span id="cb11-276"><a href="#cb11-276" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np, os</span>
<span id="cb11-277"><a href="#cb11-277" aria-hidden="true" tabindex="-1"></a>BASE <span class="op">=</span> os.path.expanduser(<span class="st">"~/Desktop/deliverable3_feature_extraction"</span>)</span>
<span id="cb11-278"><a href="#cb11-278" aria-hidden="true" tabindex="-1"></a>out_path <span class="op">=</span> os.path.join(BASE, <span class="st">"data"</span>, <span class="st">"homography"</span>, <span class="st">"H.npy"</span>)</span>
<span id="cb11-279"><a href="#cb11-279" aria-hidden="true" tabindex="-1"></a>os.makedirs(os.path.dirname(out_path), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-280"><a href="#cb11-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-281"><a href="#cb11-281" aria-hidden="true" tabindex="-1"></a>np.save(out_path, H.astype(np.float32))</span>
<span id="cb11-282"><a href="#cb11-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-283"><a href="#cb11-283" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify</span></span>
<span id="cb11-284"><a href="#cb11-284" aria-hidden="true" tabindex="-1"></a>H_check <span class="op">=</span> np.load(out_path)</span>
<span id="cb11-285"><a href="#cb11-285" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Saved to:"</span>, out_path, <span class="st">"shape:"</span>, H_check.shape, <span class="st">"dtype:"</span>, H_check.dtype)</span>
<span id="cb11-286"><a href="#cb11-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-287"><a href="#cb11-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-288"><a href="#cb11-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-289"><a href="#cb11-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-290"><a href="#cb11-290" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Sanity Check (Homography Validation).</span></span>
<span id="cb11-291"><a href="#cb11-291" aria-hidden="true" tabindex="-1"></a>To evaluate the correctness of the homography transformation, we reprojected four manually chosen base points (Home, 1B, 2B, and 3B) into real-world field coordinates.  </span>
<span id="cb11-292"><a href="#cb11-292" aria-hidden="true" tabindex="-1"></a>The coordinates found were about Home (0.0, 0.0), 1B (90.0, 0.0), 2B (90.0, 90.0), and 3B (0.0, 90.0), completely matching the normal baseball infield dimensions of 90 × 90 ft. This indicates that the transformation matrix accurately preserves spatial geometry, making the pixel-to-field mapping reliable for player position estimation.</span>
<span id="cb11-293"><a href="#cb11-293" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb11-294"><a href="#cb11-294" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-295"><a href="#cb11-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-296"><a href="#cb11-296" aria-hidden="true" tabindex="-1"></a>check_ft <span class="op">=</span> apply_homography(H, src_pts)</span>
<span id="cb11-297"><a href="#cb11-297" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"mapped 4 corners (feet):</span><span class="ch">\n</span><span class="st">"</span>, check_ft)</span>
<span id="cb11-298"><a href="#cb11-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-299"><a href="#cb11-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-300"><a href="#cb11-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-301"><a href="#cb11-301" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Convert any pixel (click one or fill manually)</span></span>
<span id="cb11-302"><a href="#cb11-302" aria-hidden="true" tabindex="-1"></a>A new pixel point (such as the runner's foot) is picked. It is translated from pixel coordinates (842.32, 395.44) to field coordinates (65.93 ft, 81.76 ft), demonstrating successful 2D-to-real-world mapping.</span>
<span id="cb11-303"><a href="#cb11-303" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-304"><a href="#cb11-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-305"><a href="#cb11-305" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">110</span>)</span>
<span id="cb11-306"><a href="#cb11-306" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)<span class="op">;</span> plt.title(<span class="st">"Click runner foot (1 point)"</span>)</span>
<span id="cb11-307"><a href="#cb11-307" aria-hidden="true" tabindex="-1"></a>runner_click <span class="op">=</span> plt.ginput(<span class="dv">1</span>, timeout<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb11-308"><a href="#cb11-308" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb11-309"><a href="#cb11-309" aria-hidden="true" tabindex="-1"></a>runner_px <span class="op">=</span> np.array(runner_click, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb11-310"><a href="#cb11-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-311"><a href="#cb11-311" aria-hidden="true" tabindex="-1"></a><span class="co"># runner_px = np.array([[1200, 900]], dtype=float)  # Manual values can be used as substitutes</span></span>
<span id="cb11-312"><a href="#cb11-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-313"><a href="#cb11-313" aria-hidden="true" tabindex="-1"></a>runner_ft <span class="op">=</span> apply_homography(H, runner_px)</span>
<span id="cb11-314"><a href="#cb11-314" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"runner pixel -&gt; feet:"</span>, runner_px, <span class="st">"=&gt;"</span>, runner_ft)</span>
<span id="cb11-315"><a href="#cb11-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-316"><a href="#cb11-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-317"><a href="#cb11-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-318"><a href="#cb11-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-319"><a href="#cb11-319" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Overlay labels for report</span></span>
<span id="cb11-320"><a href="#cb11-320" aria-hidden="true" tabindex="-1"></a>The selected base points (Home, 1B, 2B, and 3B) are superimposed on the image with yellow labels to ensure that all points were accurately registered throughout the transformation process.</span>
<span id="cb11-321"><a href="#cb11-321" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-322"><a href="#cb11-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-323"><a href="#cb11-323" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb11-324"><a href="#cb11-324" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb11-325"><a href="#cb11-325" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">"Home"</span>,<span class="st">"1B"</span>,<span class="st">"2B"</span>,<span class="st">"3B"</span>]</span>
<span id="cb11-326"><a href="#cb11-326" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x,y),lab <span class="kw">in</span> <span class="bu">zip</span>(src_pts, labels):</span>
<span id="cb11-327"><a href="#cb11-327" aria-hidden="true" tabindex="-1"></a>    plt.scatter([x],[y], s<span class="op">=</span><span class="dv">110</span>, facecolors<span class="op">=</span><span class="st">'none'</span>, edgecolors<span class="op">=</span><span class="st">'yellow'</span>, linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb11-328"><a href="#cb11-328" aria-hidden="true" tabindex="-1"></a>    plt.text(x<span class="op">+</span><span class="dv">8</span>, y<span class="op">-</span><span class="dv">8</span>, lab, color<span class="op">=</span><span class="st">'yellow'</span>,</span>
<span id="cb11-329"><a href="#cb11-329" aria-hidden="true" tabindex="-1"></a>             bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.55</span>, pad<span class="op">=</span><span class="dv">2</span>), fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb11-330"><a href="#cb11-330" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Selected points (Home → 1B → 2B → 3B)"</span>)</span>
<span id="cb11-331"><a href="#cb11-331" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-332"><a href="#cb11-332" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb11-333"><a href="#cb11-333" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig("selected_points_overlay.png", dpi=160, bbox_inches='tight')</span></span>
<span id="cb11-334"><a href="#cb11-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-335"><a href="#cb11-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-336"><a href="#cb11-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-337"><a href="#cb11-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-338"><a href="#cb11-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-339"><a href="#cb11-339" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Summary of Conversion</span></span>
<span id="cb11-340"><a href="#cb11-340" aria-hidden="true" tabindex="-1"></a>The validated homography matrix was used to map the selected player's foot to real-world coordinates of about (X = 65.93 ft, Y = 81.76 ft).  This point is fairly close to the pitcher's mound (approximately 60.5 feet from home plate), demonstrating the geometric correctness and reliability of our coordinate translation.  The results show that our homography-based method can successfully transform 2D pixel positions from a video frame to genuine on-field locations with realistic precision.</span>
<span id="cb11-341"><a href="#cb11-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-342"><a href="#cb11-342" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-343"><a href="#cb11-343" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(check_ft)</span>
<span id="cb11-344"><a href="#cb11-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-345"><a href="#cb11-345" aria-hidden="true" tabindex="-1"></a>pt <span class="op">=</span> np.<span class="bu">round</span>(runner_ft, <span class="dv">2</span>) </span>
<span id="cb11-346"><a href="#cb11-346" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Runner (feet) ≈ X=</span><span class="sc">{</span>pt[<span class="dv">0</span>,<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> ft, Y=</span><span class="sc">{</span>pt[<span class="dv">0</span>,<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> ft"</span>)</span>
<span id="cb11-347"><a href="#cb11-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-348"><a href="#cb11-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-349"><a href="#cb11-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-350"><a href="#cb11-350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 9: Measure distance between two outfielders  </span></span>
<span id="cb11-351"><a href="#cb11-351" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-352"><a href="#cb11-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-353"><a href="#cb11-353" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.1 Load the same broadcast frame and ask the user to click two outfielders</span></span>
<span id="cb11-354"><a href="#cb11-354" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">"outfield_frame.png"</span>)</span>
<span id="cb11-355"><a href="#cb11-355" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb11-356"><a href="#cb11-356" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb11-357"><a href="#cb11-357" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Click two outfielders (left → right)"</span>)</span>
<span id="cb11-358"><a href="#cb11-358" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-359"><a href="#cb11-359" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb11-360"><a href="#cb11-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-361"><a href="#cb11-361" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect two pixel coordinates (click left OF first, then right OF)</span></span>
<span id="cb11-362"><a href="#cb11-362" aria-hidden="true" tabindex="-1"></a>of_px <span class="op">=</span> plt.ginput(<span class="dv">2</span>, timeout<span class="op">=</span><span class="dv">0</span>)     <span class="co"># returns [(x1,y1), (x2,y2)]</span></span>
<span id="cb11-363"><a href="#cb11-363" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb11-364"><a href="#cb11-364" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Clicked pixel coords (outfielders):"</span>, of_px)</span>
<span id="cb11-365"><a href="#cb11-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-366"><a href="#cb11-366" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.2 Convert pixel coordinates to field coordinates (feet) via homography</span></span>
<span id="cb11-367"><a href="#cb11-367" aria-hidden="true" tabindex="-1"></a>of_ft <span class="op">=</span> apply_homography(H, np.array(of_px, dtype<span class="op">=</span><span class="bu">float</span>))</span>
<span id="cb11-368"><a href="#cb11-368" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Outfielders in field coordinates (feet):</span><span class="ch">\n</span><span class="st">"</span>, np.<span class="bu">round</span>(of_ft, <span class="dv">2</span>))</span>
<span id="cb11-369"><a href="#cb11-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-370"><a href="#cb11-370" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.3 Compute Euclidean distance between the two outfielders in feet</span></span>
<span id="cb11-371"><a href="#cb11-371" aria-hidden="true" tabindex="-1"></a>dist_ft <span class="op">=</span> <span class="bu">float</span>(np.linalg.norm(of_ft[<span class="dv">0</span>] <span class="op">-</span> of_ft[<span class="dv">1</span>]))</span>
<span id="cb11-372"><a href="#cb11-372" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Distance between outfielders ≈ </span><span class="sc">{</span>dist_ft<span class="sc">:.2f}</span><span class="ss"> ft"</span>)</span>
<span id="cb11-373"><a href="#cb11-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-374"><a href="#cb11-374" aria-hidden="true" tabindex="-1"></a><span class="co"># 9.4 (Optional) Visual overlay for the report</span></span>
<span id="cb11-375"><a href="#cb11-375" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">140</span>)</span>
<span id="cb11-376"><a href="#cb11-376" aria-hidden="true" tabindex="-1"></a>plt.imshow(img)</span>
<span id="cb11-377"><a href="#cb11-377" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb11-378"><a href="#cb11-378" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Outfielders distance ≈ </span><span class="sc">{</span>dist_ft<span class="sc">:.1f}</span><span class="ss"> ft"</span>)</span>
<span id="cb11-379"><a href="#cb11-379" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x, y), label <span class="kw">in</span> <span class="bu">zip</span>(of_px, [<span class="st">"OF-1"</span>, <span class="st">"OF-2"</span>]):</span>
<span id="cb11-380"><a href="#cb11-380" aria-hidden="true" tabindex="-1"></a>    plt.scatter([x], [y], s<span class="op">=</span><span class="dv">120</span>, c<span class="op">=</span><span class="st">'cyan'</span>, marker<span class="op">=</span><span class="st">'x'</span>, linewidths<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb11-381"><a href="#cb11-381" aria-hidden="true" tabindex="-1"></a>    plt.text(x<span class="op">+</span><span class="dv">10</span>, y<span class="op">-</span><span class="dv">10</span>, label, color<span class="op">=</span><span class="st">'cyan'</span>,</span>
<span id="cb11-382"><a href="#cb11-382" aria-hidden="true" tabindex="-1"></a>             bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.55</span>, pad<span class="op">=</span><span class="dv">2</span>), fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb11-383"><a href="#cb11-383" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-384"><a href="#cb11-384" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig("outfielders_distance_overlay.png", dpi=160, bbox_inches='tight')</span></span>
<span id="cb11-385"><a href="#cb11-385" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb11-386"><a href="#cb11-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-387"><a href="#cb11-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-388"><a href="#cb11-388" aria-hidden="true" tabindex="-1"></a>The results demonstrate that two outfielders were manually selected from the video frame, with pixel coordinates (367.85, 1108.08) and (1863.53, 1174.72).  These pixel positions were then converted into real-world field coordinates using the previously computed homography matrix, yielding approximations of (-31.39, 38.27) ft and (41.13, -54.64) ft.</span>
<span id="cb11-389"><a href="#cb11-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-390"><a href="#cb11-390" aria-hidden="true" tabindex="-1"></a> The software calculated the Euclidean distance between these two positions and decided that the outfielders are separated by around 117.9 feet on the field.  This figure is appropriate for a Major League Baseball outfield arrangement in which players normally maintain a spacing of 110-130 feet, depending on stadium geometry and defensive placement.</span>
<span id="cb11-391"><a href="#cb11-391" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb11-392"><a href="#cb11-392" aria-hidden="true" tabindex="-1"></a>The visualization additionally marks the two selected positions as "OF-1" and "OF-2" on the image, indicating that the transformation correctly transfers on-screen player placements to their real-world distances.</span>
<span id="cb11-393"><a href="#cb11-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-394"><a href="#cb11-394" aria-hidden="true" tabindex="-1"></a><span class="fu">### AI Assistance Statement</span></span>
<span id="cb11-395"><a href="#cb11-395" aria-hidden="true" tabindex="-1"></a>AI assistance: ChatGPT was used extensively in this deliverable. </span>
<span id="cb11-396"><a href="#cb11-396" aria-hidden="true" tabindex="-1"></a>It helps me understand better what I should do for this week's deliverable, and it guides me step by step with my prompt.</span>
<span id="cb11-397"><a href="#cb11-397" aria-hidden="true" tabindex="-1"></a>The majority of the code structure, Python functions, and written explanations were initially </span>
<span id="cb11-398"><a href="#cb11-398" aria-hidden="true" tabindex="-1"></a>generated with AI assistance. I used ChatGPT to help me draft prototype code for homography </span>
<span id="cb11-399"><a href="#cb11-399" aria-hidden="true" tabindex="-1"></a>computation, coordinate transformation, visualization, and distance calculation. </span>
<span id="cb11-400"><a href="#cb11-400" aria-hidden="true" tabindex="-1"></a>I then executed all code myself, debugged errors, verified the homography outputs, selected </span>
<span id="cb11-401"><a href="#cb11-401" aria-hidden="true" tabindex="-1"></a>the calibration points, confirmed the pixel-to-field mapping, and interpreted every result.  </span>
<span id="cb11-402"><a href="#cb11-402" aria-hidden="true" tabindex="-1"></a>This document reflects my understanding of the method, while the AI tool assisted me in writing </span>
<span id="cb11-403"><a href="#cb11-403" aria-hidden="true" tabindex="-1"></a>and structuring the initial code and explanations.</span>
<span id="cb11-404"><a href="#cb11-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-405"><a href="#cb11-405" aria-hidden="true" tabindex="-1"></a>Homography transformation to map pixel coordinates to field coordinates:</span>
<span id="cb11-406"><a href="#cb11-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-407"><a href="#cb11-407" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/duo.png)</span></span>
<span id="cb11-408"><a href="#cb11-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-409"><a href="#cb11-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-410"><a href="#cb11-410" aria-hidden="true" tabindex="-1"></a>**Quality Checks**:</span>
<span id="cb11-411"><a href="#cb11-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-412"><a href="#cb11-412" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Base square ≈ 90 ft sides (±2 ft)</span>
<span id="cb11-413"><a href="#cb11-413" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Foul lines approximately orthogonal</span>
<span id="cb11-414"><a href="#cb11-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Residual reprojection error ≤ 2 px</span>
<span id="cb11-415"><a href="#cb11-415" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reject if fewer than 4 reliable points</span>
<span id="cb11-416"><a href="#cb11-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-417"><a href="#cb11-417" aria-hidden="true" tabindex="-1"></a>**Impact**:</span>
<span id="cb11-418"><a href="#cb11-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-419"><a href="#cb11-419" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Converts video into model-ready geometry (feet)</span>
<span id="cb11-420"><a href="#cb11-420" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Makes features comparable across games/stadiums/cameras</span>
<span id="cb11-421"><a href="#cb11-421" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enables true distance calculations for <span class="in">`outfield_spread_ft`</span></span>
<span id="cb11-422"><a href="#cb11-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-423"><a href="#cb11-423" aria-hidden="true" tabindex="-1"></a><span class="fu">### Samuel Bulnes: Model Accuracy Testing</span></span>
<span id="cb11-424"><a href="#cb11-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-425"><a href="#cb11-425" aria-hidden="true" tabindex="-1"></a>**Objective**: Optimize feature set while maintaining performance</span>
<span id="cb11-426"><a href="#cb11-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-427"><a href="#cb11-427" aria-hidden="true" tabindex="-1"></a>**Feature Reduction Analysis**:</span>
<span id="cb11-428"><a href="#cb11-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-429"><a href="#cb11-429" aria-hidden="true" tabindex="-1"></a>Original model: 45 features → Optimized: 10 features (-78% complexity)</span>
<span id="cb11-430"><a href="#cb11-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-431"><a href="#cb11-431" aria-hidden="true" tabindex="-1"></a>**Top 10 Features by Importance**:</span>
<span id="cb11-432"><a href="#cb11-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-433"><a href="#cb11-433" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`runner_base`</span> (28.6%)</span>
<span id="cb11-434"><a href="#cb11-434" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="in">`hit_distance`</span> (27.9%)</span>
<span id="cb11-435"><a href="#cb11-435" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="in">`bearing`</span> (10.5%)</span>
<span id="cb11-436"><a href="#cb11-436" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span><span class="in">`launch_angle`</span> (7.5%)</span>
<span id="cb11-437"><a href="#cb11-437" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span><span class="in">`launch_direction`</span> (6.9%)</span>
<span id="cb11-438"><a href="#cb11-438" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span><span class="in">`exit_speed`</span> (4.8%)</span>
<span id="cb11-439"><a href="#cb11-439" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span><span class="in">`hangtime`</span> (4.5%)</span>
<span id="cb11-440"><a href="#cb11-440" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span><span class="in">`exit_speed_squared`</span> (4.4%)</span>
<span id="cb11-441"><a href="#cb11-441" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span><span class="in">`fielder_pos`</span> (2.5%)</span>
<span id="cb11-442"><a href="#cb11-442" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span><span class="in">`outfield_spread_event`</span> (2.5%)</span>
<span id="cb11-443"><a href="#cb11-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-444"><a href="#cb11-444" aria-hidden="true" tabindex="-1"></a>**Performance Validation**:</span>
<span id="cb11-445"><a href="#cb11-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-446"><a href="#cb11-446" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Model <span class="pp">|</span> 45 Features <span class="pp">|</span> 10 Features <span class="pp">|</span> Change <span class="pp">|</span></span>
<span id="cb11-447"><a href="#cb11-447" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------|-------------|-------------|--------|</span></span>
<span id="cb11-448"><a href="#cb11-448" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Random Forest <span class="pp">|</span> 0.3951 <span class="pp">|</span> 0.3795 <span class="pp">|</span> +3.9%  <span class="pp">|</span></span>
<span id="cb11-449"><a href="#cb11-449" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Gradient Boosting <span class="pp">|</span> 0.3647 <span class="pp">|</span> 0.3890 <span class="pp">|</span> -6.7% <span class="pp">|</span></span>
<span id="cb11-450"><a href="#cb11-450" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Logistic Regression <span class="pp">|</span> 0.4200 <span class="pp">|</span> 0.4416 <span class="pp">|</span> -5.1% <span class="pp">|</span></span>
<span id="cb11-451"><a href="#cb11-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-452"><a href="#cb11-452" aria-hidden="true" tabindex="-1"></a>**Best Model**: Random Forest with 10 features (Log Loss = 0.3795)</span>
<span id="cb11-453"><a href="#cb11-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-454"><a href="#cb11-454" aria-hidden="true" tabindex="-1"></a>**Impact**:</span>
<span id="cb11-455"><a href="#cb11-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-456"><a href="#cb11-456" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>70%+ reduction in data prep and training time</span>
<span id="cb11-457"><a href="#cb11-457" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Maintains core predictive signal</span>
<span id="cb11-458"><a href="#cb11-458" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Faster retraining and lighter deployment</span>
<span id="cb11-459"><a href="#cb11-459" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ready for production scaling</span>
<span id="cb11-460"><a href="#cb11-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-461"><a href="#cb11-461" aria-hidden="true" tabindex="-1"></a><span class="fu">## Technical Achievements</span></span>
<span id="cb11-462"><a href="#cb11-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-463"><a href="#cb11-463" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Computer Vision Pipeline</span></span>
<span id="cb11-464"><a href="#cb11-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-465"><a href="#cb11-465" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**YOLOv8 Integration**: Real-time player detection </span>
<span id="cb11-466"><a href="#cb11-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-467"><a href="#cb11-467" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Position Classification**: Automatic LF/CF/RF assignment </span>
<span id="cb11-468"><a href="#cb11-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-469"><a href="#cb11-469" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Catch Detection**: Ball-to-player distance calculation </span>
<span id="cb11-470"><a href="#cb11-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-471"><a href="#cb11-471" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**ID Persistence**: Track players across frames </span>
<span id="cb11-472"><a href="#cb11-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-473"><a href="#cb11-473" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Spatial Features</span></span>
<span id="cb11-474"><a href="#cb11-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-475"><a href="#cb11-475" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Outfield Spread**: Quantitative field coverage metric </span>
<span id="cb11-476"><a href="#cb11-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-477"><a href="#cb11-477" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Fielder Position**: Categorical catch assignment </span>
<span id="cb11-478"><a href="#cb11-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-479"><a href="#cb11-479" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Pixel-to-Feet Conversion**: Real-world distance calculations </span>
<span id="cb11-480"><a href="#cb11-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-481"><a href="#cb11-481" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Multi-Camera Support**: Homography-based calibration  </span>
<span id="cb11-482"><a href="#cb11-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-483"><a href="#cb11-483" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Model Optimization</span></span>
<span id="cb11-484"><a href="#cb11-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-485"><a href="#cb11-485" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Feature Selection**: 45 → 10 features with minimal loss</span>
<span id="cb11-486"><a href="#cb11-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-487"><a href="#cb11-487" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Performance Validation**: Cross-validation across models</span>
<span id="cb11-488"><a href="#cb11-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-489"><a href="#cb11-489" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Importance Analysis**: Identify key predictive features</span>
<span id="cb11-490"><a href="#cb11-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-491"><a href="#cb11-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Challenges &amp; Solutions</span></span>
<span id="cb11-492"><a href="#cb11-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-493"><a href="#cb11-493" aria-hidden="true" tabindex="-1"></a><span class="fu">### Challenge 1: Player Detection in Crowds</span></span>
<span id="cb11-494"><a href="#cb11-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-495"><a href="#cb11-495" aria-hidden="true" tabindex="-1"></a>**Problem**: YOLO detects fans and non-players</span>
<span id="cb11-496"><a href="#cb11-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-497"><a href="#cb11-497" aria-hidden="true" tabindex="-1"></a>**Solution**: Adaptive area thresholds + vertical band filtering</span>
<span id="cb11-498"><a href="#cb11-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-499"><a href="#cb11-499" aria-hidden="true" tabindex="-1"></a><span class="fu">### Challenge 2: Camera Angle Variations</span></span>
<span id="cb11-500"><a href="#cb11-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-501"><a href="#cb11-501" aria-hidden="true" tabindex="-1"></a>**Problem**: Different stadiums/broadcasts have different perspectives</span>
<span id="cb11-502"><a href="#cb11-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-503"><a href="#cb11-503" aria-hidden="true" tabindex="-1"></a>**Solution**: Homography calibration per video with quality checks</span>
<span id="cb11-504"><a href="#cb11-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-505"><a href="#cb11-505" aria-hidden="true" tabindex="-1"></a><span class="fu">### Challenge 3: Model Complexity</span></span>
<span id="cb11-506"><a href="#cb11-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-507"><a href="#cb11-507" aria-hidden="true" tabindex="-1"></a>**Problem**: 45 features slow down training and deployment</span>
<span id="cb11-508"><a href="#cb11-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-509"><a href="#cb11-509" aria-hidden="true" tabindex="-1"></a>**Solution**: Feature importance analysis → keep top 10 features</span>
<span id="cb11-510"><a href="#cb11-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-511"><a href="#cb11-511" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Metrics</span></span>
<span id="cb11-512"><a href="#cb11-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-513"><a href="#cb11-513" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Frame Processing**: 271 FPS extraction speed</span>
<span id="cb11-514"><a href="#cb11-514" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Player Detection**: 10.8% frame visibility rate</span>
<span id="cb11-515"><a href="#cb11-515" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Model Performance**: Log Loss 0.3795 (10 features)</span>
<span id="cb11-516"><a href="#cb11-516" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Complexity Reduction**: 78% fewer features</span>
<span id="cb11-517"><a href="#cb11-517" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Storage Savings**: 50% reduction with 30 FPS</span>
<span id="cb11-518"><a href="#cb11-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-519"><a href="#cb11-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-520"><a href="#cb11-520" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb11-521"><a href="#cb11-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-522"><a href="#cb11-522" aria-hidden="true" tabindex="-1"></a>*Week 2 transformed raw video into structured, model-ready data through advanced computer vision and feature engineering.*</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Keaton-Ruthardt/AIBaseballProject/edit/main/week2.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/Keaton-Ruthardt/AIBaseballProject/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>